parameters:
  - name: code
    in: path
    description: Code of the existing plan.
    required: true
    schema:
      type: string
      example: 'startup'
post:
  tags:
    - entitlements
  summary: Create an entitlement
  description: This endpoint creates new entitlements by adding features to a plan. Note that all existing entitlements will be deleted and replaced by the ones provided. To add a new entitlement without removing the existing ones, use PATCH. The feature must exist and all privileges must be valid for the feature.
  operationId: createEntitlement
  requestBody:
    description: Entitlement payload
    content:
      application/json:
        schema:
          $ref: '../schemas/Entitlement/EntitlementUpdateInput.yaml'
    required: true
  responses:
    '200':
      description: Entitlement created
      content:
        application/json:
          schema:
            $ref: '../schemas/Entitlement/PlanEntitlements.yaml'
    '400':
      $ref: '../responses/BadRequest.yaml'
    '401':
      $ref: '../responses/Unauthorized.yaml'
    '404':
      $ref: '../responses/NotFound.yaml'
    '422':
      $ref: '../responses/UnprocessableEntity.yaml'
get:
  tags:
    - entitlements
  summary: List all entitlements
  description: This endpoint retrieves all entitlements for a specific plan.
  operationId: findAllEntitlements
  responses:
    '200':
      description: List of entitlements
      content:
        application/json:
          schema:
            $ref: '../schemas/Entitlement/PlanEntitlements.yaml'
    '401':
      $ref: '../responses/Unauthorized.yaml'
    '404':
      $ref: '../responses/NotFound.yaml'
patch:
  tags:
    - entitlements
  summary: Partial update of an entitlement
  description: This accepts a list of entitlements to update. If the feature isn't part of the plan yet, it's added with all the privileges from the payload. If the feature is already part of the plan, the privilege and values are updated or added. All privileges must be valid for the feature. All features  and privileges not part of the payload are left untouched. To remove privileges or features, use the DELETE endpoints.
  operationId: updateEntitlement
  requestBody:
    description: Entitlement payload
    content:
      application/json:
        schema:
          $ref: '../schemas/Entitlement/EntitlementUpdateInput.yaml'
    required: true
  responses:
    '200':
      description: Entitlement updated
      content:
        application/json:
          schema:
            $ref: '../schemas/Entitlement/PlanEntitlements.yaml'
    '400':
      $ref: '../responses/BadRequest.yaml'
    '401':
      $ref: '../responses/Unauthorized.yaml'
    '404':
      $ref: '../responses/NotFound.yaml'
    '422':
      $ref: '../responses/UnprocessableEntity.yaml'
